PREPARING MESH FOR MESHFEM3D

{'tag': 'nk_small', 'dir_name': './created/nk_small', 'lat_min': 40.5, 'lat_max': 45.5, 'lon_min': 126.0, 'lon_max': 134.0, 'utm_projection': 52, 'suppress_utm_proj': False, 'mesh_depth_km': 400.0, 'mesh_top_km': 0, 'doubling_layers': [50], 'interfaces': [0, 45], 'interface_increase': [2, 2], 'interface_fids': ['interface_topo.dat', 'interface_1.dat'], 'regions': [15, 45, 95], 'materials': [[4400, 7500, 4500, 9999, 1001], [6500, 8500, 4500, 9999, 1000], [7500, 9000, 4500, 9999, 1000], [7500, 9000, 4500, 9999, 1000]], 'nproc': 4, 'grid_space_top_hv': [5, 5], 'shortest_period_s': 3.0, 'vs_min_km_per_s': 1.5, 'vp_max_km_per_s': 8.8, 'points_per_wl': 5, 'top_vertical_element_ratio': 1.0}

PARAMETERS FOR: nk_small
	tag: nk_small
	dir_name: ./created/nk_small
	lat_min: 40.5
	lat_max: 45.5
	lon_min: 126.0
	lon_max: 134.0
	utm_projection: 52
	suppress_utm_proj: False
	mesh_depth_km: 400.0
	mesh_top_km: 0
	doubling_layers: [50]
	interfaces: [0, 45]
	interface_increase: [2, 2]
	interface_fids: ['interface_topo.dat', 'interface_1.dat']
	regions: [15, 45, 95]
	materials: [[4400, 7500, 4500, 9999, 1001], [6500, 8500, 4500, 9999, 1000], [7500, 9000, 4500, 9999, 1000], [7500, 9000, 4500, 9999, 1000]]
	nproc: 4
	grid_space_top_hv: [5, 5]
	shortest_period_s: 3.0
	vs_min_km_per_s: 1.5
	vp_max_km_per_s: 8.8
	points_per_wl: 5
	top_vertical_element_ratio: 1.0
CALCULATING MINIMUM GRID SPACE AT TOP OF MESH
	Grid space XYZ given
	MIN GRID SPACE HORIZONTAL: 5
	MIN GRID SPACE VERTICAL: 5
CALCULATING NUMBER OF PROCESSORS
	x-axis length = 644.8455351677607
	y-axis length = 563.0894747246932
	short direction is 'y'
	NPROC_X = 2
	NPROC_Y = 2
CALCULATING NUMBER OF ELEMENTS AT TOP OF MESH
	integer multiple found as c=7
	NEX_X = 192
	NEX_Y = 192
	!!! enforcing NEX_PER_PROC_XI == 2c * 2 ** ndoublings
		NEX_X: 192 -> 192
	!!! enforcing NEX_PER_PROC_ETA == 2c * 2 ** ndoublings
		NEX_Y: 192 -> 192
	DX = 3.3586km
	DY = 2.9328km
	Note: if values below too large, adjust 'shortest_period_s'
	Note: if values below too small, check  'suppress_utm_proj'
	GRID_SPACE_H - DX = 1.64142950433458
	GRID_SPACE_H - DY = 2.0672423191422227
SCALING VERTICAL ELEMENT SIZE BASED ON DX and DY
	DZ = (dx + dy)/2 * 1.0 ~= 3
CALCULATING NUMBER OF VERTICAL LAYERS (interfaces)
	8 layers of 6km between 0km and 45km (48 km)
	30 layers of 12km between 45km and 400.0km (360 km)
	NLAYERS = 2
	NELEMENTS_Z = 38
	NUM ELEM PER LAYER FROM BOTTOM = [30, 8]
FORMATTING HORIZONTAL DOUBLING LAYERS (ndoublings)
	depth 50km is approx element 26 at depth 54.00km
	NDOUBLING LAYERS = [26]
FORMATTING NREGIONS AND NMATERIALS
	nregions = nmaterials = 4
	depth 95km is approx element 19 at depth 96.00km
	depth 45km is approx element 27 at depth 48.00km
	depth 15km is approx element 33 at depth 18.00km
	depth 0km is top of mesh 0km
	REGION STARTING ELEMENT = [38, 33, 27, 19]
MESH HAS THE APPROXIMATE FORM
	38/00; Z~=  0.00km
		Top of Mesh
		Interface (vertical x2)
		Region 1 begins
		dx=3.36, dy=2.93, dz=6
	37/01; Z~= -6.00km
	36/02; Z~=-12.00km
	35/03; Z~=-18.00km
	34/04; Z~=-24.00km
	33/05; Z~=-30.00km
		Region 2 begins
		dx=3.36, dy=2.93, dz=6
	32/06; Z~=-36.00km
	31/07; Z~=-42.00km
	30/08; Z~=-48.00km
		Interface (vertical x2)
		dx=3.36, dy=2.93, dz=12
	29/09; Z~=-60.00km
	28/10; Z~=-72.00km
	27/11; Z~=-84.00km
		Region 3 begins
		dx=3.36, dy=2.93, dz=12
	26/12; Z~=-96.00km
		Doubling (horizontal doubling)
		dx=6.72, dy=5.87, dz=12
	25/13; Z~=-108.00km
	24/14; Z~=-120.00km
	23/15; Z~=-132.00km
	22/16; Z~=-144.00km
	21/17; Z~=-156.00km
	20/18; Z~=-168.00km
	19/19; Z~=-180.00km
		Region 4 begins
		dx=6.72, dy=5.87, dz=12
	18/20; Z~=-192.00km
	17/21; Z~=-204.00km
	16/22; Z~=-216.00km
	15/23; Z~=-228.00km
	14/24; Z~=-240.00km
	13/25; Z~=-252.00km
	12/26; Z~=-264.00km
	11/27; Z~=-276.00km
	10/28; Z~=-288.00km
	09/29; Z~=-300.00km
	08/30; Z~=-312.00km
	07/31; Z~=-324.00km
	06/32; Z~=-336.00km
	05/33; Z~=-348.00km
	04/34; Z~=-360.00km
	03/35; Z~=-372.00km
	02/36; Z~=-384.00km
	01/37; Z~=-396.00km
WRITING Mesh_Par_file
WRITING interfaces.dat
WRITING INTERACE interface_topo.dat
WRITING INTERACE interface_1.dat
APPROXIMATING TOTAL NUMBER OF ELEMENTS IN MESH
	APPRX_NUM_ELEM = 709632
